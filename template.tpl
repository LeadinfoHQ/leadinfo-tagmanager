___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Leadinfo",
  "categories": ["LEAD_GENERATION", "SALES"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "Custom Template",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Identify B2B website visitors. Simple and real-time.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "siteId",
    "displayName": "Site ID",
    "simpleValueType": true,
    "notSetText": "Site ID is required",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "REGEX",
        "args": [
          "LI-[A-Z0-9]*"
        ]
      }
    ],
    "valueHint": "Get your site ID from the activation mail or when logged in under settings."
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const createQueue = require('createQueue');
const copyFromWindow = require('copyFromWindow');
const setInWindow = require('setInWindow');
const callInWindow = require('callInWindow');
const injectScript = require('injectScript');

// Access the generic settings
const siteId = data.siteId;

// Build the Snowplow global namespace and return the tracker
const getSp = () => {
  const snowplow = copyFromWindow('leadinfo');
  if (snowplow) {
    return snowplow;
  }

  const globalNamespace = createQueue('GlobalLeadinfoNamespace');
  globalNamespace('leadinfo');

  setInWindow('leadinfo', function() {
    callInWindow('leadinfo.q.push', arguments);
  });
  setInWindow('leadinfo.t', siteId);
  createQueue('leadinfo.q');
  return copyFromWindow('leadinfo');
};

getSp();

// Execute the command and arguments
//callInWindow('leadinfo.apply', null, []);

injectScript('https://cdn.leadinfo.net/ping.js', data.gtmOnSuccess, data.gtmOnFailure, 'lilibrary');




___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "leadinfo"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "GlobalLeadinfoNamespace"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "leadinfo.q"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "leadinfo.q.push"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "leadinfo.apply"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "leadinfo.t"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdn.leadinfo.net/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 08/06/2020, 09:12:54


